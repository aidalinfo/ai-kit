---
title: Outils & tool loop
description: Déclarer des outils par défaut et contrôler la boucle loopTools
sidebar:
  order: 3
locale: fr-FR
---

Les outils permettent à vos agents de déclencher du code applicatif (recherche, requêtes API, calculs métier...). AI Kit les enregistre au niveau de l'agent et les injecte automatiquement dans chaque appel.

## Ajouter des outils par défaut

```ts
import { Agent, google } from "@ai_kit/core";

const assistant = new Agent({
  name: "assistant-vie",
  instructions: "Assistant de vie",
  model: google("gemini-2.5-flash"),
  tools: {
    google_search: google.tools.googleSearch({}),
  },
  loopTools: true,
  maxStepTools: 15,
});

await assistant.generate({ prompt: "Quelle est la météo à Paris ?" });
```

Passez l'option `tools` pour exposer des outils sur tous les appels. Vous pouvez toujours les remplacer ponctuellement en fournissant `tools` directement dans `generate` ou `stream`.  
De la même manière, `loopTools` et `maxStepTools` configurés sur l'agent servent de valeur par défaut que chaque appel peut surcharger.

## Boucle d'outils automatique

Lorsque `loopTools` est activé et que l'agent dispose d'outils, AI Kit orchestre automatiquement les appels : après chaque réponse du modèle contenant des `toolCalls`, les outils correspondants s'exécutent puis la conversation reprend jusqu'à obtenir du texte final. Le résultat expose un indicateur `loopTool: true` pour faciliter l'inspection DX.

```ts
const result = await assistant.generate({
  prompt: "Cherche la documentation du workflow 'tool loop'.",
  loopTools: true,
});

if (result.loopTool) {
  console.log("Des outils ont été exécutés pendant la conversation.");
}
```

Ajustez la boucle via :

- `loopTools?: boolean` sur l'agent pour activer la boucle (désactivée par défaut, même si des outils sont déclarés).
- `maxStepTools?: number` pour plafonner le nombre total d'outils exécutés avant de couper la boucle (défaut : `20`).
- Sur un appel, surchargez `loopTools` ou `maxStepTools` dans `agent.generate({...})` ou `agent.stream({...})`.

```ts
// L'agent est configuré avec loopTools: true,
// mais on peut le neutraliser pour un appel ponctuel :
await assistant.generate({
  prompt: "Réponds sans exécuter d'outils.",
  loopTools: false,
});
```
